<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF Chatbot Readiness Scanner</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    </script>
    <style>
        .upload-zone {
            transition: all 0.3s ease;
        }
        .upload-zone:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <div class="max-w-5xl mx-auto p-6">
        <!-- Header -->
        <div class="text-center mb-10">
            <div class="mb-4">
                <div class="w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center mx-auto mb-4">
                    <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                </div>
            </div>
            <h1 class="text-4xl font-bold text-gray-900 mb-3">
                PDF Chatbot Readiness Scanner
            </h1>
            <p class="text-lg text-gray-600 max-w-2xl mx-auto">
                Instantly check if benefits documents are suitable for our chatbot system. 
                Get YES/NO decisions in seconds with detailed confidence scoring.
            </p>
        </div>

        <!-- Main Content -->
        <div class="bg-white rounded-2xl shadow-xl p-8">
            <!-- Upload Section -->
            <div id="upload-section" class="mb-8">
                <div id="upload-zone" 
                     class="upload-zone border-3 border-dashed border-blue-300 rounded-xl p-12 text-center bg-blue-50 hover:bg-blue-100 cursor-pointer">
                    <div class="mb-6">
                        <svg class="w-16 h-16 text-blue-400 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                        </svg>
                    </div>
                    <div class="text-xl font-semibold text-blue-600 mb-2">Upload PDF Document</div>
                    <div class="text-gray-500 mb-4">Drag and drop your PDF here, or click to browse</div>
                    <div class="text-sm text-gray-400">Maximum file size: 50MB â€¢ Only PDF files accepted</div>
                    <input type="file" id="file-input" accept=".pdf" class="hidden">
                </div>
            </div>

            <!-- File Info Section -->
            <div id="file-info" class="hidden mb-8">
                <div class="bg-gray-50 rounded-lg p-6">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-4">
                            <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                                <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                </svg>
                            </div>
                            <div>
                                <div id="file-name" class="font-semibold text-gray-900"></div>
                                <div id="file-size" class="text-sm text-gray-500"></div>
                            </div>
                        </div>
                        <div class="flex space-x-3">
                            <button id="remove-btn" class="px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors">
                                Remove
                            </button>
                            <button id="analyze-btn" class="px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors font-semibold">
                                Analyze Document
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Analysis Progress -->
            <div id="analysis-progress" class="hidden mb-8">
                <div class="bg-blue-50 rounded-lg p-6">
                    <div class="flex items-center space-x-4">
                        <div class="spinner"></div>
                        <div>
                            <div class="font-semibold text-blue-900">Analyzing PDF Structure...</div>
                            <div class="text-sm text-blue-700" id="progress-text">Extracting text and analyzing document quality</div>
                        </div>
                    </div>
                    <div class="mt-4">
                        <div class="w-full bg-blue-200 rounded-full h-2">
                            <div id="progress-bar" class="bg-blue-600 h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Results Section -->
            <div id="results" class="hidden fade-in">
                <!-- Main Result Card -->
                <div id="result-card" class="rounded-xl p-8 border-2 mb-6">
                    <div class="flex items-center space-x-4 mb-6">
                        <div id="result-icon" class="w-12 h-12 rounded-full flex items-center justify-center">
                            <!-- Icon will be inserted here -->
                        </div>
                        <div>
                            <div id="result-title" class="text-2xl font-bold"></div>
                            <div id="result-confidence" class="text-lg"></div>
                        </div>
                    </div>
                    <div id="result-message" class="text-base mb-4"></div>
                    <div id="recommendation" class="hidden">
                        <div class="bg-white rounded-lg p-4 border">
                            <div class="font-semibold mb-2">ðŸ’¡ Recommendation:</div>
                            <div class="font-medium text-red-800">â†’ Professional Guide Service Recommended</div>
                            <div class="text-sm mt-2 text-gray-600">
                                Our team can optimize this document to ensure perfect chatbot compatibility.
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Detailed Breakdown -->
                <div class="bg-white border border-gray-200 rounded-lg p-6 mb-6">
                    <h4 class="font-semibold text-gray-900 mb-6 text-lg">Analysis Breakdown</h4>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div class="text-center">
                            <div class="w-20 h-20 mx-auto mb-3 relative">
                                <svg class="transform -rotate-90 w-20 h-20">
                                    <circle cx="10" cy="10" r="8" stroke="#e5e7eb" stroke-width="2" fill="none" class="translate-x-1 translate-y-1"/>
                                    <circle id="text-circle" cx="10" cy="10" r="8" stroke="#3b82f6" stroke-width="2" fill="none" 
                                            stroke-dasharray="50.27" stroke-dashoffset="50.27" class="translate-x-1 translate-y-1"/>
                                </svg>
                                <div class="absolute inset-0 flex items-center justify-center">
                                    <span id="text-score" class="text-sm font-bold text-blue-600">0%</span>
                                </div>
                            </div>
                            <div class="font-medium text-gray-900">Text Accessibility</div>
                            <div class="text-sm text-gray-500">Searchable content quality</div>
                        </div>
                        <div class="text-center">
                            <div class="w-20 h-20 mx-auto mb-3 relative">
                                <svg class="transform -rotate-90 w-20 h-20">
                                    <circle cx="10" cy="10" r="8" stroke="#e5e7eb" stroke-width="2" fill="none" class="translate-x-1 translate-y-1"/>
                                    <circle id="structure-circle" cx="10" cy="10" r="8" stroke="#10b981" stroke-width="2" fill="none" 
                                            stroke-dasharray="50.27" stroke-dashoffset="50.27" class="translate-x-1 translate-y-1"/>
                                </svg>
                                <div class="absolute inset-0 flex items-center justify-center">
                                    <span id="structure-score" class="text-sm font-bold text-green-600">0%</span>
                                </div>
                            </div>
                            <div class="font-medium text-gray-900">Document Structure</div>
                            <div class="text-sm text-gray-500">Organization & navigation</div>
                        </div>
                        <div class="text-center">
                            <div class="w-20 h-20 mx-auto mb-3 relative">
                                <svg class="transform -rotate-90 w-20 h-20">
                                    <circle cx="10" cy="10" r="8" stroke="#e5e7eb" stroke-width="2" fill="none" class="translate-x-1 translate-y-1"/>
                                    <circle id="table-circle" cx="10" cy="10" r="8" stroke="#f59e0b" stroke-width="2" fill="none" 
                                            stroke-dasharray="50.27" stroke-dashoffset="50.27" class="translate-x-1 translate-y-1"/>
                                </svg>
                                <div class="absolute inset-0 flex items-center justify-center">
                                    <span id="table-score" class="text-sm font-bold text-yellow-600">0%</span>
                                </div>
                            </div>
                            <div class="font-medium text-gray-900">Table Quality</div>
                            <div class="text-sm text-gray-500">Data structure readability</div>
                        </div>
                    </div>
                </div>

                <!-- Actions -->
                <div class="flex justify-center space-x-4">
                    <button id="reset-btn" class="px-6 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors font-semibold">
                        Analyze Another Document
                    </button>
                    <button id="proceed-btn" class="hidden px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-semibold">
                        âœ… Proceed with Setup
                    </button>
                    <button id="guide-btn" class="hidden px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold">
                        ðŸ“‹ Request Guide Service
                    </button>
                </div>
            </div>

            <!-- Error Display -->
            <div id="error-display" class="hidden">
                <div class="bg-red-50 border border-red-200 rounded-lg p-4 flex items-center space-x-3">
                    <svg class="w-5 h-5 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <span id="error-message" class="text-red-800"></span>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="text-center mt-8 text-sm text-gray-500">
            <p>Standalone PDF Chatbot Readiness Scanner â€¢ No data leaves your browser â€¢ Powered by PDF.js</p>
        </div>
    </div>

    <script>
        // PDF Analysis Engine
        class PDFAnalyzer {
            constructor() {
                this.maxFileSize = 50 * 1024 * 1024; // 50MB
            }

            async analyzePDF(file) {
                const arrayBuffer = await file.arrayBuffer();
                const pdf = await pdfjsLib.getDocument(arrayBuffer).promise;
                
                // Analyze different aspects
                const textAnalysis = await this.analyzeText(pdf);
                const structureAnalysis = await this.analyzeStructure(pdf);
                const tableAnalysis = await this.analyzeTables(pdf);
                
                return this.calculateScore(textAnalysis, structureAnalysis, tableAnalysis);
            }

            async analyzeText(pdf) {
                let totalText = '';
                let meaningfulPages = 0;
                let totalChars = 0;
                const samplePages = Math.min(5, pdf.numPages);

                for (let i = 1; i <= samplePages; i++) {
                    const page = await pdf.getPage(i);
                    const textContent = await page.getTextContent();
                    const text = textContent.items.map(item => item.str).join(' ');
                    
                    const charCount = text.replace(/\s+/g, '').length;
                    if (charCount > 100) {
                        meaningfulPages++;
                        totalChars += charCount;
                    }
                    totalText += text + ' ';
                }

                const estimatedMeaningfulPages = (meaningfulPages / samplePages) * pdf.numPages;
                const searchableRatio = estimatedMeaningfulPages / pdf.numPages;
                const avgCharsPerPage = totalChars / Math.max(meaningfulPages, 1);

                return {
                    searchableRatio,
                    avgCharsPerPage,
                    hasGoodText: avgCharsPerPage > 300,
                    totalPages: pdf.numPages
                };
            }

            async analyzeStructure(pdf) {
                const firstPage = await pdf.getPage(1);
                const textContent = await firstPage.getTextContent();
                const text = textContent.items.map(item => item.str).join('\n');
                
                const lines = text.split('\n').filter(line => line.trim().length > 0);
                let headingCount = 0;

                // Look for heading patterns
                for (const line of lines.slice(0, 20)) { // Check first 20 lines
                    const trimmed = line.trim();
                    if (trimmed.length < 80 && (
                        trimmed === trimmed.toUpperCase() ||
                        trimmed.endsWith(':') ||
                        /^\d+\./.test(trimmed) ||
                        /^[A-Z][a-z]+\s+[A-Z]/.test(trimmed)
                    )) {
                        headingCount++;
                    }
                }

                return {
                    pageCount: pdf.numPages,
                    reasonableLength: pdf.numPages >= 1 && pdf.numPages <= 100,
                    headingCount,
                    wellOrganized: headingCount >= 2
                };
            }

            async analyzeTables(pdf) {
                // Simplified table detection based on text layout patterns
                let tableIndicators = 0;
                const samplePages = Math.min(3, pdf.numPages);

                for (let i = 1; i <= samplePages; i++) {
                    const page = await pdf.getPage(i);
                    const textContent = await page.getTextContent();
                    const text = textContent.items.map(item => item.str).join(' ');
                    
                    // Look for table-like patterns
                    const lines = text.split('\n');
                    for (const line of lines) {
                        // Common table indicators
                        if (line.includes('$') && /\d/.test(line) && line.split(/\s+/).length >= 3) {
                            tableIndicators++;
                        }
                        if (/\d+%/.test(line) && line.split(/\s+/).length >= 3) {
                            tableIndicators++;
                        }
                        if (line.match(/\d+\.\d+/) && line.split(/\s+/).length >= 4) {
                            tableIndicators++;
                        }
                    }
                }

                const hasComplexTables = tableIndicators > 5;
                const tableQuality = hasComplexTables ? 0.6 : 0.9; // Complex tables harder for chatbot

                return {
                    tableQuality,
                    tableCount: Math.floor(tableIndicators / 3),
                    hasComplexTables
                };
            }

            calculateScore(textAnalysis, structureAnalysis, tableAnalysis) {
                let score = 0;

                // Text accessibility (60% weight)
                let textScore = textAnalysis.searchableRatio * 40;
                if (textAnalysis.hasGoodText) {
                    textScore += 20;
                }
                score += Math.min(textScore, 60);

                // Document structure (20% weight)
                let structureScore = 0;
                if (structureAnalysis.reasonableLength) {
                    structureScore += 10;
                }
                if (structureAnalysis.wellOrganized) {
                    structureScore += 10;
                }
                score += structureScore;

                // Table quality (20% weight)
                score += tableAnalysis.tableQuality * 20;

                const finalScore = Math.round(Math.max(0, Math.min(score, 100)));
                const suitable = finalScore >= 70;

                return {
                    suitable,
                    confidence: finalScore,
                    breakdown: {
                        textAccessibility: Math.round(Math.min(textScore, 60)),
                        documentStructure: structureScore,
                        tableQuality: Math.round(tableAnalysis.tableQuality * 20)
                    },
                    details: {
                        textAnalysis,
                        structureAnalysis,
                        tableAnalysis
                    }
                };
            }
        }

        // UI Controller
        class UIController {
            constructor() {
                this.analyzer = new PDFAnalyzer();
                this.currentFile = null;
                this.initializeEventListeners();
            }

            initializeEventListeners() {
                const uploadZone = document.getElementById('upload-zone');
                const fileInput = document.getElementById('file-input');
                const analyzeBtn = document.getElementById('analyze-btn');
                const removeBtn = document.getElementById('remove-btn');
                const resetBtn = document.getElementById('reset-btn');

                // Upload zone events
                uploadZone.addEventListener('click', () => fileInput.click());
                uploadZone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    uploadZone.classList.add('bg-blue-100');
                });
                uploadZone.addEventListener('dragleave', () => {
                    uploadZone.classList.remove('bg-blue-100');
                });
                uploadZone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    uploadZone.classList.remove('bg-blue-100');
                    const files = e.dataTransfer.files;
                    if (files.length > 0) {
                        this.handleFileSelection(files[0]);
                    }
                });

                // File input change
                fileInput.addEventListener('change', (e) => {
                    if (e.target.files.length > 0) {
                        this.handleFileSelection(e.target.files[0]);
                    }
                });

                // Button events
                analyzeBtn.addEventListener('click', () => this.analyzePDF());
                removeBtn.addEventListener('click', () => this.reset());
                resetBtn.addEventListener('click', () => this.reset());
            }

            handleFileSelection(file) {
                if (!file.type.includes('pdf')) {
                    this.showError('Please select a PDF file only.');
                    return;
                }

                if (file.size > this.analyzer.maxFileSize) {
                    this.showError('File is too large. Maximum size is 50MB.');
                    return;
                }

                this.currentFile = file;
                this.showFileInfo(file);
                this.hideError();
            }

            showFileInfo(file) {
                document.getElementById('file-name').textContent = file.name;
                document.getElementById('file-size').textContent = `${(file.size / 1024 / 1024).toFixed(2)} MB`;
                
                document.getElementById('upload-section').classList.add('hidden');
                document.getElementById('file-info').classList.remove('hidden');
            }

            async analyzePDF() {
                if (!this.currentFile) return;

                this.showProgress();

                try {
                    // Simulate progress updates
                    this.updateProgress(10, 'Reading PDF structure...');
                    await this.delay(500);
                    
                    this.updateProgress(40, 'Analyzing text content...');
                    await this.delay(500);
                    
                    this.updateProgress(70, 'Checking document organization...');
                    const result = await this.analyzer.analyzePDF(this.currentFile);
                    
                    this.updateProgress(90, 'Calculating readiness score...');
                    await this.delay(300);
                    
                    this.updateProgress(100, 'Analysis complete!');
                    await this.delay(500);

                    this.showResults(result);
                } catch (error) {
                    console.error('Analysis failed:', error);
                    this.showError('Analysis failed. Please try a different PDF file.');
                    this.hideProgress();
                }
            }

            showProgress() {
                document.getElementById('file-info').classList.add('hidden');
                document.getElementById('analysis-progress').classList.remove('hidden');
            }

            hideProgress() {
                document.getElementById('analysis-progress').classList.add('hidden');
            }

            updateProgress(percent, text) {
                document.getElementById('progress-bar').style.width = `${percent}%`;
                document.getElementById('progress-text').textContent = text;
            }

            showResults(result) {
                this.hideProgress();
                
                // Main result card
                const resultCard = document.getElementById('result-card');
                const resultIcon = document.getElementById('result-icon');
                const resultTitle = document.getElementById('result-title');
                const resultConfidence = document.getElementById('result-confidence');
                const resultMessage = document.getElementById('result-message');
                const recommendation = document.getElementById('recommendation');

                if (result.suitable) {
                    resultCard.className = 'rounded-xl p-8 border-2 mb-6 bg-green-50 border-green-200';
                    resultIcon.className = 'w-12 h-12 rounded-full flex items-center justify-center bg-green-100';
                    resultIcon.innerHTML = '<svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>';
                    resultTitle.textContent = 'âœ… APPROVED - Chatbot Ready';
                    resultTitle.className = 'text-2xl font-bold text-green-900';
                    resultConfidence.textContent = `${result.confidence}% Confidence Score`;
                    resultConfidence.className = 'text-lg text-green-800';
                    resultMessage.textContent = 'This document will work well with our chatbot system.';
                    resultMessage.className = 'text-base mb-4 text-green-800';
                    recommendation.classList.add('hidden');
                    document.getElementById('proceed-btn').classList.remove('hidden');
                    document.getElementById('guide-btn').classList.add('hidden');
                } else {
                    resultCard.className = 'rounded-xl p-8 border-2 mb-6 bg-red-50 border-red-200';
                    resultIcon.className = 'w-12 h-12 rounded-full flex items-center justify-center bg-red-100';
                    resultIcon.innerHTML = '<svg class="w-6 h-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>';
                    resultTitle.textContent = 'âŒ NOT SUITABLE';
                    resultTitle.className = 'text-2xl font-bold text-red-900';
                    resultConfidence.textContent = `${result.confidence}% Confidence Score`;
                    resultConfidence.className = 'text-lg text-red-800';
                    resultMessage.textContent = 'This document needs optimization for chatbot compatibility.';
                    resultMessage.className = 'text-base mb-4 text-red-800';
                    recommendation.classList.remove('hidden');
                    document.getElementById('proceed-btn').classList.add('hidden');
                    document.getElementById('guide-btn').classList.remove('hidden');
                }

                // Update breakdown circles
                this.animateCircle('text-circle', 'text-score', result.breakdown.textAccessibility, '#3b82f6');
                this.animateCircle('structure-circle', 'structure-score', result.breakdown.documentStructure, '#10b981');
                this.animateCircle('table-circle', 'table-score', result.breakdown.tableQuality, '#f59e0b');

                document.getElementById('results').classList.remove('hidden');
            }

            animateCircle(circleId, scoreId, percentage, color) {
                const circle = document.getElementById(circleId);
                const scoreElement = document.getElementById(scoreId);
                const circumference = 2 * Math.PI * 8; // radius = 8
                const offset = circumference - (percentage / 100) * circumference;
                
                circle.style.stroke = color;
                circle.style.strokeDashoffset = offset;
                scoreElement.textContent = `${percentage}%`;
                
                // Add animation class
                circle.style.transition = 'stroke-dashoffset 1s ease-in-out';
            }

            showError(message) {
                document.getElementById('error-message').textContent = message;
                document.getElementById('error-display').classList.remove('hidden');
            }

            hideError() {
                document.getElementById('error-display').classList.add('hidden');
            }

            reset() {
                this.currentFile = null;
                document.getElementById('upload-section').classList.remove('hidden');
                document.getElementById('file-info').classList.add('hidden');
                document.getElementById('analysis-progress').classList.add('hidden');
                document.getElementById('results').classList.add('hidden');
                document.getElementById('file-input').value = '';
                this.hideError();
            }

            delay(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }
        }

        // Initialize the application when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            new UIController();
        });
    </script>
</body>
</html>